import{j as s}from"./index-BMoS0DUA.js";import{u as A,h as T,b as B,f as d,k as u,l as C}from"./index-TNyY8g-O.js";import"./_commonjsHelpers-BosuxZz1.js";import"./immer-DZPz5TFl.js";const y=window.antd.Button,M=window.antd.Descriptions,N=window.antd.Image,w=window.antd.Tag,f=window.antd.Tooltip,h=window.antd.Typography,F=window.React.forwardRef,I=window.React.useEffect,Y=window.React.useImperativeHandle,E=window.React.useMemo,b=window.React.useState,P=({id:m,type:j,config:a},k)=>{var c;const[g,i]=b(!0),[t,l]=b([]),D=A(e=>e.page.variableData);I(()=>{S({})},[a.api,((c=a.api)==null?void 0:c.sourceType)=="variable"?D:""]);const S=e=>{T(a.api,e).then(r=>{(r==null?void 0:r.ret)===0&&(Array.isArray(r.data)?l(r.data):l([r.data]))})};Y(k,()=>({show(){i(!0)},hide(){i(!1)}}));const p=(e,r)=>{const o=a.events.find(n=>n.eventName===e);C(o==null?void 0:o.actions,r)},v=(e,r,o)=>{if(B(e)?r.type==="money"?e=d(e,"currency"):r.type==="number"?e=d(e):r.type==="date1"?e=u(e,"YYYY-MM-DD"):r.type==="date2"&&(e=u(e)):typeof a.props.empty>"u"?e="-":a.props.empty&&(e=a.props.empty),r.render)try{e=new Function("text","record",`return (${r.render})(text,record);`)(e,o)}catch(n){console.error(`列[${r.title}]渲染失败`,n),e="解析异常"}if(r.type==="text"){const n=s.jsx(y,{type:"link",onClick:()=>p(r.eventName,o),children:e.toString()});return r.ellipsis&&r.copyable?s.jsx(f,{title:e,children:s.jsx(h.Paragraph,{copyable:!0,style:{marginBottom:0},children:r.clickable?n:e.toString()})}):r.ellipsis?s.jsx(f,{title:e,children:r.clickable?n:e.toString()}):r.copyable?s.jsx(h.Paragraph,{copyable:!0,children:r.clickable?n:e.toString()}):r.clickable?s.jsx(y,{type:"link",onClick:()=>p(r.eventName,o),children:e.toString()}):e.toString()}return r.type==="image"?s.jsx(N,{src:e,width:30}):r.type==="tag"?Array.isArray(e)?e.map(n=>s.jsx(w,{children:n},n)):typeof e=="string"||typeof e=="number"?s.jsx(w,{children:e}):e==null?void 0:e.toString():e},R=E(()=>a.props.items.map(e=>{var n;const r=((n=t[0])==null?void 0:n[e.name])||"",o=v(r,e,t[0]||{});return{key:e.key,label:e.label,children:o}}),[a.props.items,t]);return g&&s.jsx(M,{...a.props,items:R,"data-id":m,"data-type":j,style:a.style})},q=F(P);export{q as Descriptions};
