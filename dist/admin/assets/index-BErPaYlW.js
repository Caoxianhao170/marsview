import{j as c}from"./index-BvzOCTvp.js";import{u as x,i as R,h as T}from"./index-BpWof7b7.js";import{F as y}from"./context-V_gTMpak.js";import"./_commonjsHelpers-BosuxZz1.js";import"./immer-DZPz5TFl.js";const D=window.antd.Form,I=window.antd.TreeSelect,F=window.React.forwardRef,j=window.React.useContext,o=window.React.useEffect,C=window.React.useImperativeHandle,l=window.React.useState,V=({id:W,type:A,config:e,onChange:p},w)=>{var m;const s=j(y),[f,d]=l([]),[b,n]=l(!0),[v,r]=l(!1),S=x(t=>t.page.variableData);o(()=>{var u;const t=(u=e.props.formItem)==null?void 0:u.name,a=e.props.defaultValue;t&&!R(a)&&(s==null||s.setFieldValue(t,a))},[e.props.defaultValue]),o(()=>{r(e.props.formWrap.disabled||!1)},[e.props.formWrap.disabled]),o(()=>{i({})},[e.api,((m=e.api)==null?void 0:m.sourceType)=="variable"?S:""]);const i=t=>{T(e.api,t).then(a=>{(a==null?void 0:a.ret)===0&&(Array.isArray(a.data)?d(a.data):(console.error("[TreeSelect]","data数据格式错误，请检查"),d([])))})};C(w,()=>({show(){n(!0)},hide(){n(!1)},enable(){r(!1)},disable(){r(!0)},update:t=>{i(t)}}));const h=t=>{p&&p({[e.props.formItem.name]:t})};return b&&c.jsx(D.Item,{...e.props.formItem,children:c.jsx(I,{...e.props.formWrap,disabled:v,variant:e.props.formWrap.variant||void 0,treeData:f,style:e.style,onChange:t=>h(t)})})},P=F(V);export{P as TreeSelect};
